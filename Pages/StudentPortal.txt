import React, { useState, useEffect } from "react";
import { base44 } from "@/api/base44Client";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { GraduationCap, BookOpen, Briefcase, DollarSign } from "lucide-react";
import ChatInterface from "../components/ai/ChatInterface";
import { Link } from "react-router-dom";
import { createPageUrl } from "@/utils";
import { Button } from "@/components/ui/button";

export default function StudentPortal() {
  const [user, setUser] = useState(null);

  useEffect(() => {
    const loadUser = async () => {
      try {
        const currentUser = await base44.auth.me();
        setUser(currentUser);
      } catch (error) {
        console.log("User not logged in");
      }
    };
    loadUser();
  }, []);

  const systemPrompt = `You are a Student Assistant AI for Indian students. You help with:
- Education schemes and scholarships
- Career guidance and college selection
- Exam preparation tips
- Study abroad information
- Skill development programs
- Internship and job opportunities for students

You provide information about various educational programs, scholarships, competitive exams, and career paths available to Indian students. You're supportive, encouraging, and provide accurate, helpful information.`;

  const quickLinks = [
    { title: "Scholarships", description: "Find education schemes", link: createPageUrl("SchemeFinder"), icon: DollarSign },
    { title: "Jobs & Internships", description: "Career opportunities", link: createPageUrl("JobsCareer"), icon: Briefcase },
    { title: "Study Resources", description: "Legal & government info", link: createPageUrl("LegalHelp"), icon: BookOpen }
  ];

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Header */}
      <div className="bg-gradient-to-br from-pink-500 to-pink-600 text-white">
        <div className="max-w-7xl mx-auto px-4 py-12">
          <div className="flex items-center gap-3 mb-4">
            <div className="w-14 h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center">
              <GraduationCap className="w-7 h-7" />
            </div>
            <div>
              <h1 className="text-3xl md:text-4xl font-bold">Student Portal</h1>
              <p className="text-pink-100 mt-1">Your education and career companion</p>
            </div>
          </div>
        </div>
      </div>

      <div className="max-w-7xl mx-auto px-4 py-8">
        <div className="grid lg:grid-cols-3 gap-6">
          {/* Quick Links */}
          <div className="space-y-4">
            <h2 className="font-semibold text-lg">Quick Access</h2>
            {quickLinks.map((link, index) => (
              <Link key={index} to={link.link}>
                <Card className="hover:shadow-md transition-all cursor-pointer">
                  <CardContent className="p-4">
                    <div className="flex items-center gap-3">
                      <div className="w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center">
                        <link.icon className="w-5 h-5 text-pink-600" />
                      </div>
                      <div>
                        <p className="font-medium">{link.title}</p>
                        <p className="text-xs text-gray-500">{link.description}</p>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </Link>
            ))}

            <Card>
              <CardHeader>
                <CardTitle className="text-base">Popular Schemes</CardTitle>
              </CardHeader>
              <CardContent className="space-y-2">
                <div className="text-sm">
                  <p className="font-medium">National Scholarship Portal</p>
                  <p className="text-xs text-gray-500">scholarships.gov.in</p>
                </div>
                <div className="text-sm">
                  <p className="font-medium">PM Scholarship Scheme</p>
                  <p className="text-xs text-gray-500">For students</p>
                </div>
                <div className="text-sm">
                  <p className="font-medium">Post Matric Scholarship</p>
                  <p className="text-xs text-gray-500">SC/ST/OBC students</p>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* AI Chat Assistant */}
          <div className="lg:col-span-2">
            <Card className="h-[calc(100vh-250px)] min-h-[600px] overflow-hidden">
              <ChatInterface
                assistantType="Student"
                assistantName="Student Assistant"
                systemPrompt={systemPrompt}
                user={user}
              />
            </Card>
          </div>
        </div>
      </div>
    </div>
  );
}